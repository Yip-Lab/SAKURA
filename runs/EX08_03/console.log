pydev debugger: process 37114 is connecting

SCARE/SAKRA Prototype
Loading dataset...
Working directory: /Users/hahaschool/Desktop/Research/SAKRA
Reproducibe seed: 114514
Loading expression matrix from mtx (MM) file.
==========================
rna_count dataset (sparse MM version):
Imported gene expression matrix from: ./dataset/10X_PBMC_integrated_purified_and_cite/cleaned_log_unfiltered_expr_mat.mtx
Imported gene names from: ./dataset/10X_PBMC_integrated_purified_and_cite/cleaned_log_unfiltered_gene_names.csv
Imported cell names from: ./dataset/10X_PBMC_integrated_purified_and_cite/cleaned_log_unfiltered_cell_names.csv
(19705, 102520)
cell     CD14+_Monocytes-AAACATACCACTAG-1  ...  CD14+_Monocytes-AAACATTGACGGTT-1
gene                                       ...                                  
FAM138A                          0.000000  ...                          0.000000
OR4F5                            0.000000  ...                          0.000000
OR4F29                           0.000000  ...                          0.000000
OR4F16                           0.000000  ...                          0.000000
FAM87B                           0.000000  ...                          0.000000
...                                   ...  ...                               ...
MT-ND4L                          0.000000  ...                          0.000000
MT-ND4                           2.807975  ...                          0.000000
MT-ND5                           0.000000  ...                          0.000000
MT-ND6                           0.000000  ...                          0.000000
MT-CYB                           0.000000  ...                          2.709732

[19705 rows x 3 columns]
No external gene expression set provided, using dummy.
Gene expression set metadata:
{'all': {'gene_list': '*', 'pre_procedure': [], 'post_procedure': [{'type': 'ToTensor'}]}}
Phenotype data from CSV from: ./dataset/10X_PBMC_integrated_purified_and_cite/pheno.csv
(102520, 18)
                                                           data_key  ...  IgG2b.control.TotalSeqB
CD14+_Monocytes-AAACATACCACTAG-1                    CD14+_Monocytes  ...                      NaN
CD14+_Monocytes-AAACATACGTTCAG-1                    CD14+_Monocytes  ...                      NaN
CD14+_Monocytes-AAACATTGACGGTT-1                    CD14+_Monocytes  ...                      NaN
CD14+_Monocytes-AAACATTGCTTCGC-1                    CD14+_Monocytes  ...                      NaN
CD14+_Monocytes-AAACATTGGGCAAG-1                    CD14+_Monocytes  ...                      NaN
...                                                             ...  ...                      ...
V3_with_protein_barcode-TTTGTTGGTTCAAGTC-1  V3_with_protein_barcode  ...                 1.832918
V3_with_protein_barcode-TTTGTTGGTTGCATGT-1  V3_with_protein_barcode  ...                 2.719305
V3_with_protein_barcode-TTTGTTGGTTGCGGCT-1  V3_with_protein_barcode  ...                 2.410259
V3_with_protein_barcode-TTTGTTGTCGAGTGAG-1  V3_with_protein_barcode  ...                 1.199049
V3_with_protein_barcode-TTTGTTGTCGTTCAGA-1  V3_with_protein_barcode  ...                 1.508487

[102520 rows x 18 columns]
Reading phenotype metadata json from: ./runs/EX08_03/pheno_meta.json
==========================
Configuration integrity pre-check ok: True
=================
Imported external splits from ./runs/EX08_03/splits.pkl
External splits: {'all': array([1., 1., 1., ..., 1., 1., 1.]), 'protein_v3': array([0, 0, 0, ..., 1, 1, 1]), 'pure_v1': array([1, 1, 1, ..., 0, 0, 0]), 'pure_v1_overall_train': array([ True, False,  True, ..., False, False, False]), 'pure_v1_overall_test': array([False,  True, False, ..., False, False, False]), 'protein_v3_overall_train': array([False, False, False, ...,  True,  True,  True]), 'protein_v3_overall_test': array([False, False, False, ..., False, False, False]), 'merged_overall_train': array([ True, False,  True, ...,  True,  True,  True]), 'merged_overall_test': array([False,  True, False, ..., False, False, False])}
Merged splits: {'all': array([1., 1., 1., ..., 1., 1., 1.]), 'protein_v3': array([0, 0, 0, ..., 1, 1, 1]), 'pure_v1': array([1, 1, 1, ..., 0, 0, 0]), 'pure_v1_overall_train': array([ True, False,  True, ..., False, False, False]), 'pure_v1_overall_test': array([False,  True, False, ..., False, False, False]), 'protein_v3_overall_train': array([False, False, False, ...,  True,  True,  True]), 'protein_v3_overall_test': array([False, False, False, ..., False, False, False]), 'merged_overall_train': array([ True, False,  True, ...,  True,  True,  True]), 'merged_overall_test': array([False,  True, False, ..., False, False, False])}
Skipped main splits
Skipped pheno splits for: data_key
Skipped pheno splits for: protein_markers
==========================
Splits:
{'all': array([1., 1., 1., ..., 1., 1., 1.]), 'protein_v3': array([0, 0, 0, ..., 1, 1, 1]), 'pure_v1': array([1, 1, 1, ..., 0, 0, 0]), 'pure_v1_overall_train': array([ True, False,  True, ..., False, False, False]), 'pure_v1_overall_test': array([False,  True, False, ..., False, False, False]), 'protein_v3_overall_train': array([False, False, False, ...,  True,  True,  True]), 'protein_v3_overall_test': array([False, False, False, ..., False, False, False]), 'merged_overall_train': array([ True, False,  True, ...,  True,  True,  True]), 'merged_overall_test': array([False,  True, False, ..., False, False, False])}
Model built:
ModuleDict(
  (decoder): FCDecoder(
    (model_list): ModuleList(
      (0): Linear(in_features=6, out_features=50, bias=True)
      (1): CELU(alpha=1.0)
      (2): Linear(in_features=50, out_features=50, bias=True)
      (3): CELU(alpha=1.0)
      (4): Linear(in_features=50, out_features=19705, bias=True)
    )
  )
  (main_latent_compressor): FCCompressor(
    (model_list): ModuleList(
      (0): Linear(in_features=50, out_features=2, bias=True)
    )
    (model): Sequential(
      (0): ModuleList(
        (0): Linear(in_features=50, out_features=2, bias=True)
      )
    )
  )
  (pheno_latent_compressors): ModuleDict(
    (data_key): FCCompressor(
      (model_list): ModuleList(
        (0): Linear(in_features=50, out_features=2, bias=True)
      )
      (model): Sequential(
        (0): ModuleList(
          (0): Linear(in_features=50, out_features=2, bias=True)
        )
      )
    )
    (protein_markers): FCCompressor(
      (model_list): ModuleList(
        (0): Linear(in_features=50, out_features=2, bias=True)
      )
      (model): Sequential(
        (0): ModuleList(
          (0): Linear(in_features=50, out_features=2, bias=True)
        )
      )
    )
  )
  (pheno_models): ModuleDict(
    (data_key): LinClassifier(
      (model_list): ModuleList(
        (0): Linear(in_features=2, out_features=11, bias=True)
        (1): LogSoftmax()
      )
      (model): Sequential(
        (0): ModuleList(
          (0): Linear(in_features=2, out_features=11, bias=True)
          (1): LogSoftmax()
        )
      )
    )
    (protein_markers): FCRegressor(
      (model_list): ModuleList(
        (0): Linear(in_features=2, out_features=5, bias=True)
        (1): CELU(alpha=1.0)
        (2): Linear(in_features=5, out_features=5, bias=True)
        (3): CELU(alpha=1.0)
        (4): Linear(in_features=5, out_features=17, bias=True)
      )
      (model): Sequential(
        (0): ModuleList(
          (0): Linear(in_features=2, out_features=5, bias=True)
          (1): CELU(alpha=1.0)
          (2): Linear(in_features=5, out_features=5, bias=True)
          (3): CELU(alpha=1.0)
          (4): Linear(in_features=5, out_features=17, bias=True)
        )
      )
    )
  )
  (pre_encoder): FCPreEncoder(
    (model_list): ModuleList(
      (0): Linear(in_features=19705, out_features=50, bias=True)
      (1): CELU(alpha=1.0)
      (2): Linear(in_features=50, out_features=50, bias=True)
      (3): CELU(alpha=1.0)
    )
  )
  (signature_latent_compressors): ModuleDict()
  (signature_regressors): ModuleDict()
)
===========================
Extractor controller
{'data_key': {'pheno_df_key': 'data_key', 'type': 'categorical', 'order': ['CD14+_Monocytes', 'CD19+_B_Cells', 'CD34+_Cells', 'CD4+_CD25+_Regulatory_T_Cells', 'CD4+_CD45RA+_CD25-_Naive_T_cells', 'CD4+_CD45RO+_Memory_T_Cells', 'CD4+_Helper_T_Cells', 'CD56+_Natural_Killer_Cells', 'CD8+_CD45RA+_Naive_Cytotoxic_T_Cells', 'CD8+_Cytotoxic_T_cells', 'V3_with_protein_barcode'], 'pheno_lat_dim': 2, 'pheno_out_dim': 11, 'model': {'type': 'LinClassifier'}, 'loss': {'NLL': {'type': 'NLL', 'init_weight': 1.0, 'progressive_start_epoch': 100, 'progressive_const': 1.0}}, 'pre_procedure': [], 'post_procedure': [{'type': 'ToOrdinal'}, {'type': 'ToTensor'}], 'split': {'type': 'none'}, 'regularization': {'shape_uniform_unsupervised': {'type': 'SW2_uniform', 'SW2_num_projections': 50, 'uniform_low': -10, 'uniform_high': 10, 'progressive_const': 1.05, 'progressive_start_epoch': 1, 'init_weight': 0.1, 'max_weight': 1.0}}}, 'protein_markers': {'type': 'numerical', 'pheno_df_keys': ['CD3.TotalSeqB', 'CD4.TotalSeqB', 'CD8a.TotalSeqB', 'CD14.TotalSeqB', 'CD15.TotalSeqB', 'CD16.TotalSeqB', 'CD56.TotalSeqB', 'CD19.TotalSeqB', 'CD25.TotalSeqB', 'CD45RA.TotalSeqB', 'CD45RO.TotalSeqB', 'PD.1.TotalSeqB', 'TIGIT.TotalSeqB', 'CD127.TotalSeqB', 'IgG2a.control.TotalSeqB', 'IgG1.control.TotalSeqB', 'IgG2b.control.TotalSeqB'], 'pheno_lat_dim': 2, 'pheno_out_dim': 17, 'model': {'type': 'FCRegressor', 'hidden_neurons': 5}, 'loss': {'L1': {'type': 'L1', 'init_weight': 1.0, 'progressive_start_epoch': 100, 'progressive_const': 1.0}, 'L2': {'type': 'L2', 'init_weight': 1.0, 'progressive_start_epoch': 100, 'progressive_const': 1.0}}, 'pre_procedure': [], 'post_procedure': [{'type': 'ToTensor', 'force_tensor_type': 'float'}], 'split': {'type': 'none'}, 'regularization': {'shape_uniform_unsupervised': {'type': 'SW2_uniform', 'SW2_num_projections': 50, 'uniform_low': -10, 'uniform_high': 10, 'progressive_const': 1.05, 'progressive_start_epoch': 1, 'init_weight': 0.1, 'max_weight': 1.0}}}}
{}
{'encoder_neurons': 50, 'decoder_neurons': 50, 'latent_dim': 2, 'loss': {'L2': {'type': 'MSE', 'init_weight': 1.0, 'progressive_const': 1.0, 'progressive_start_epoch': 100}, 'L1': {'type': 'L1', 'init_weight': 1.0, 'progressive_const': 1.0, 'progressive_start_epoch': 100}}, 'regularization': {'uniform_shape_unsupervised': {'type': 'SW2_uniform', 'init_weight': 1, 'progressive_const': 1.1, 'progressive_start_epoch': 1, 'max_weight': 10.0, 'SW2_num_projections': 50, 'uniform_low': -10, 'uniform_high': 10}}}
RMSprop (
Parameter Group 0
    alpha: 0.9
    centered: False
    eps: 1e-08
    lr: 0.001
    momentum: 0
    weight_decay: 0
)
      main_loss_L2    main_loss_L1    main_regularization_uniform_shape_unsupervised    pheno_data_key_loss_NLL    pheno_data_key_regularization_shape_uniform_unsupervised    pheno_protein_markers_loss_L1    pheno_protein_markers_loss_L2    pheno_protein_markers_regularization_shape_uniform_unsupervised
--  --------------  --------------  ------------------------------------------------  -------------------------  ----------------------------------------------------------  -------------------------------  -------------------------------  -----------------------------------------------------------------
 0               1               1                                           1                                1                                                    0.1                                     1                                1                                                           0.1
 1               1               1                                           1.1                              1                                                    0.105                                   1                                1                                                           0.105
 2               1               1                                           1.21                             1                                                    0.11025                                 1                                1                                                           0.11025
 3               1               1                                           1.331                            1                                                    0.115763                                1                                1                                                           0.115763
 4               1               1                                           1.4641                           1                                                    0.121551                                1                                1                                                           0.121551
 5               1               1                                           1.61051                          1                                                    0.127628                                1                                1                                                           0.127628
 6               1               1                                           1.77156                          1                                                    0.13401                                 1                                1                                                           0.13401
 7               1               1                                           1.94872                          1                                                    0.14071                                 1                                1                                                           0.14071
 8               1               1                                           2.14359                          1                                                    0.147746                                1                                1                                                           0.147746
 9               1               1                                           2.35795                          1                                                    0.155133                                1                                1                                                           0.155133
10               1               1                                           2.59374                          1                                                    0.162889                                1                                1                                                           0.162889
11               1               1                                           2.85312                          1                                                    0.171034                                1                                1                                                           0.171034
12               1               1                                           3.13843                          1                                                    0.179586                                1                                1                                                           0.179586
13               1               1                                           3.45227                          1                                                    0.188565                                1                                1                                                           0.188565
14               1               1                                           3.7975                           1                                                    0.197993                                1                                1                                                           0.197993
15               1               1                                           4.17725                          1                                                    0.207893                                1                                1                                                           0.207893
16               1               1                                           4.59497                          1                                                    0.218287                                1                                1                                                           0.218287
17               1               1                                           5.05447                          1                                                    0.229202                                1                                1                                                           0.229202
18               1               1                                           5.55992                          1                                                    0.240662                                1                                1                                                           0.240662
19               1               1                                           6.11591                          1                                                    0.252695                                1                                1                                                           0.252695
20               1               1                                           6.7275                           1                                                    0.26533                                 1                                1                                                           0.26533
21               1               1                                           7.40025                          1                                                    0.278596                                1                                1                                                           0.278596
22               1               1                                           8.14027                          1                                                    0.292526                                1                                1                                                           0.292526
23               1               1                                           8.9543                           1                                                    0.307152                                1                                1                                                           0.307152
24               1               1                                           9.84973                          1                                                    0.32251                                 1                                1                                                           0.32251
25               1               1                                          10                                1                                                    0.338635                                1                                1                                                           0.338635
26               1               1                                          10                                1                                                    0.355567                                1                                1                                                           0.355567
27               1               1                                          10                                1                                                    0.373346                                1                                1                                                           0.373346
28               1               1                                          10                                1                                                    0.392013                                1                                1                                                           0.392013
29               1               1                                          10                                1                                                    0.411614                                1                                1                                                           0.411614
30               1               1                                          10                                1                                                    0.432194                                1                                1                                                           0.432194
31               1               1                                          10                                1                                                    0.453804                                1                                1                                                           0.453804
32               1               1                                          10                                1                                                    0.476494                                1                                1                                                           0.476494
33               1               1                                          10                                1                                                    0.500319                                1                                1                                                           0.500319
34               1               1                                          10                                1                                                    0.525335                                1                                1                                                           0.525335
35               1               1                                          10                                1                                                    0.551602                                1                                1                                                           0.551602
36               1               1                                          10                                1                                                    0.579182                                1                                1                                                           0.579182
37               1               1                                          10                                1                                                    0.608141                                1                                1                                                           0.608141
38               1               1                                          10                                1                                                    0.638548                                1                                1                                                           0.638548
39               1               1                                          10                                1                                                    0.670475                                1                                1                                                           0.670475
40               1               1                                          10                                1                                                    0.703999                                1                                1                                                           0.703999
41               1               1                                          10                                1                                                    0.739199                                1                                1                                                           0.739199
42               1               1                                          10                                1                                                    0.776159                                1                                1                                                           0.776159
43               1               1                                          10                                1                                                    0.814967                                1                                1                                                           0.814967
44               1               1                                          10                                1                                                    0.855715                                1                                1                                                           0.855715
45               1               1                                          10                                1                                                    0.898501                                1                                1                                                           0.898501
46               1               1                                          10                                1                                                    0.943426                                1                                1                                                           0.943426
47               1               1                                          10                                1                                                    0.990597                                1                                1                                                           0.990597
48               1               1                                          10                                1                                                    1                                       1                                1                                                           1
49               1               1                                          10                                1                                                    1                                       1                                1                                                           1
50               1               1                                          10                                1                                                    1                                       1                                1                                                           1
51               1               1                                          10                                1                                                    1                                       1                                1                                                           1
52               1               1                                          10                                1                                                    1                                       1                                1                                                           1
53               1               1                                          10                                1                                                    1                                       1                                1                                                           1
54               1               1                                          10                                1                                                    1                                       1                                1                                                           1
55               1               1                                          10                                1                                                    1                                       1                                1                                                           1
56               1               1                                          10                                1                                                    1                                       1                                1                                                           1
57               1               1                                          10                                1                                                    1                                       1                                1                                                           1
58               1               1                                          10                                1                                                    1                                       1                                1                                                           1
59               1               1                                          10                                1                                                    1                                       1                                1                                                           1
60               1               1                                          10                                1                                                    1                                       1                                1                                                           1
61               1               1                                          10                                1                                                    1                                       1                                1                                                           1
62               1               1                                          10                                1                                                    1                                       1                                1                                                           1
63               1               1                                          10                                1                                                    1                                       1                                1                                                           1
64               1               1                                          10                                1                                                    1                                       1                                1                                                           1
65               1               1                                          10                                1                                                    1                                       1                                1                                                           1
66               1               1                                          10                                1                                                    1                                       1                                1                                                           1
67               1               1                                          10                                1                                                    1                                       1                                1                                                           1
68               1               1                                          10                                1                                                    1                                       1                                1                                                           1
69               1               1                                          10                                1                                                    1                                       1                                1                                                           1
70               1               1                                          10                                1                                                    1                                       1                                1                                                           1
71               1               1                                          10                                1                                                    1                                       1                                1                                                           1
72               1               1                                          10                                1                                                    1                                       1                                1                                                           1
73               1               1                                          10                                1                                                    1                                       1                                1                                                           1
74               1               1                                          10                                1                                                    1                                       1                                1                                                           1
75               1               1                                          10                                1                                                    1                                       1                                1                                                           1
76               1               1                                          10                                1                                                    1                                       1                                1                                                           1
77               1               1                                          10                                1                                                    1                                       1                                1                                                           1
78               1               1                                          10                                1                                                    1                                       1                                1                                                           1
79               1               1                                          10                                1                                                    1                                       1                                1                                                           1
80               1               1                                          10                                1                                                    1                                       1                                1                                                           1
81               1               1                                          10                                1                                                    1                                       1                                1                                                           1
82               1               1                                          10                                1                                                    1                                       1                                1                                                           1
83               1               1                                          10                                1                                                    1                                       1                                1                                                           1
84               1               1                                          10                                1                                                    1                                       1                                1                                                           1
85               1               1                                          10                                1                                                    1                                       1                                1                                                           1
86               1               1                                          10                                1                                                    1                                       1                                1                                                           1
87               1               1                                          10                                1                                                    1                                       1                                1                                                           1
88               1               1                                          10                                1                                                    1                                       1                                1                                                           1
89               1               1                                          10                                1                                                    1                                       1                                1                                                           1
90               1               1                                          10                                1                                                    1                                       1                                1                                                           1
91               1               1                                          10                                1                                                    1                                       1                                1                                                           1
92               1               1                                          10                                1                                                    1                                       1                                1                                                           1
93               1               1                                          10                                1                                                    1                                       1                                1                                                           1
94               1               1                                          10                                1                                                    1                                       1                                1                                                           1
95               1               1                                          10                                1                                                    1                                       1                                1                                                           1
96               1               1                                          10                                1                                                    1                                       1                                1                                                           1
97               1               1                                          10                                1                                                    1                                       1                                1                                                           1
98               1               1                                          10                                1                                                    1                                       1                                1                                                           1
99               1               1                                          10                                1                                                    1                                       1                                1                                                           1
===========================
